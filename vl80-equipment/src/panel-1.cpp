#include    <panel-1.h>

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
Panel_1::Panel_1(size_t input_wires_num,
                 size_t output_wires_num,
                 QObject *parent)
    : ElectricModule(input_wires_num, output_wires_num, parent)
{

}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
Panel_1::~Panel_1()
{

}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
void Panel_1::step(double t, double dt)
{
    ElectricModule::step(t, dt);
}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
void Panel_1::init(const QString &custom_cfg_dir)
{
    K119->read_config("mk-69", custom_cfg_dir);
    K119->setInitContactState(K119_N107_N103, false);
    K119->setInitContactState(K119_C101_C130, false);
    K119->setInitContactState(K119_C302_C303, false);
}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
void Panel_1::preStep(state_vector_t &Y, double t)
{

}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
void Panel_1::ode_system(const state_vector_t &Y,
                         state_vector_t &dYdt,
                         double t)
{
    output_wire[E35_OUT] =
        input_wire[E28_IN] * static_cast<double>(S126.getState());

    output_wire[E28_OUT] =
        input_wire[E35_IN] * static_cast<double>(S126.getState());
}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
void Panel_1::load_config(CfgReader &cfg)
{
    QString secName = "Device";

    bool S126_state = false;

    cfg.getBool(secName, "S126", S126_state);

    if (S126_state)
    {
        S126.set();
    }
    else
    {
        S126.reset();
    }
}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
void Panel_1::stepKeysControl(double t, double dt)
{

}
